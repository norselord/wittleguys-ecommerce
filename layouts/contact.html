{{ define "main" }}
<div class="container" style="padding: 4rem 0; max-width: 800px; margin: 0 auto;">
    <div style="background: #fff9f3; border-radius: 16px; padding: 2rem;">
        <header style="margin-bottom: 2rem; text-align: center;">
            <h1>{{ .Title }}</h1>
        </header>
        
        <div class="content" style="margin-bottom: 2rem; color: #222; text-align: left;">
            {{ .Content }}
        </div>
        
        <style type="text/css">
          .contact-form-wrapper { max-width: 600px; margin: 20px auto; }
          .form-row { display: block; margin-bottom: 20px; }
          .form-label { font-size: 1.1em; display: block; font-weight: bold; margin-bottom: 5px; }
          .form-label.required:after { color: #e32; content: " *"; display: inline; }
          .form-input, .form-textarea { width: 100%; padding: 0.5em; border: 1px solid #CCC; background: #fff; border-radius: 4px; box-sizing: border-box; }
          .form-textarea { resize: vertical; min-height: 100px; }
          .form-button { display: inline-block; margin-bottom: 0; font-weight: 600; text-align: center; cursor: pointer; background: #3ec6a8; color: white; border: 1px solid #3ec6a8; white-space: nowrap; padding: 12px 24px; font-size: 14px; border-radius: 4px; transition: all 0.3s ease; }
          .form-button:hover { background: #359268; border-color: #359268; }
          .form-button:disabled { opacity: 0.75; cursor: not-allowed; }
          .form-error { color: red; margin-top: 5px; font-size: 0.9em; }
          .form-success { color: green; margin-bottom: 20px; padding: 10px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; }
          .recaptcha-wrapper { margin: 20px 0; }
        </style>

        <div class="contact-form-wrapper">
          <form id="contact-form" action="https://mautic.wittleguys.net/form/submit?formId=2" method="post">
            <div id="form-messages"></div>
            
            <div class="form-row">
              <label for="email" class="form-label required">Email</label>
              <input type="email" id="email" name="mauticform[email]" class="form-input" required>
              <div class="form-error" id="email-error" style="display:none;">Please enter a valid email address.</div>
            </div>
            
            <div class="form-row">
              <label for="message" class="form-label required">Message</label>
              <textarea id="message" name="mauticform[f_message]" class="form-textarea" placeholder="How can we help?" required></textarea>
              <div class="form-error" id="message-error" style="display:none;">Please enter your message.</div>
            </div>
            
            <div class="form-row recaptcha-wrapper">
              <div class="g-recaptcha" data-sitekey="6Ldvb68rAAAAAIE0RKFT-W9iKk1JbOpnrjYlJvXD"></div>
              <div class="form-error" id="recaptcha-error" style="display:none;">Please complete the reCAPTCHA verification.</div>
            </div>
            
            <input type="hidden" name="mauticform[formId]" value="2">
            <input type="hidden" name="mauticform[formName]" value="contactform">
            
            <div class="form-row">
              <button type="submit" class="form-button" id="submit-btn">
                <span class="btn-text">Send Message</span>
                <span class="btn-loading" style="display:none;">Sending...</span>
              </button>
            </div>
          </form>
        </div>

        <script>
        document.getElementById('contact-form').addEventListener('submit', function(e) {
          e.preventDefault();
          
          // Clear previous errors
          document.querySelectorAll('.form-error').forEach(el => el.style.display = 'none');
          
          // Basic validation
          let isValid = true;
          const email = document.getElementById('email').value.trim();
          const message = document.getElementById('message').value.trim();
          const recaptchaResponse = grecaptcha.getResponse();
          
          if (!email || !email.includes('@')) {
            document.getElementById('email-error').style.display = 'block';
            isValid = false;
          }
          
          if (!message) {
            document.getElementById('message-error').style.display = 'block';
            isValid = false;
          }
          
          if (!recaptchaResponse) {
            document.getElementById('recaptcha-error').style.display = 'block';
            isValid = false;
          }
          
          if (!isValid) return;
          
          // Show loading state
          const submitBtn = document.getElementById('submit-btn');
          const btnText = submitBtn.querySelector('.btn-text');
          const btnLoading = submitBtn.querySelector('.btn-loading');
          
          submitBtn.disabled = true;
          btnText.style.display = 'none';
          btnLoading.style.display = 'inline';
          
          // Submit the form
          const formData = new FormData(this);
          formData.append('g-recaptcha-response', recaptchaResponse);
          
          fetch(this.action, {
            method: 'POST',
            body: formData
          })
          .then(response => {
            if (response.ok) {
              // Success - show success message
              document.getElementById('form-messages').innerHTML = 
                '<div class="form-success">Thank you! Your message has been sent successfully. We\'ll get back to you soon!</div>';
              this.reset();
              grecaptcha.reset();
            } else {
              throw new Error('Form submission failed');
            }
          })
          .catch(error => {
            console.error('Form submission error:', error);
            document.getElementById('form-messages').innerHTML = 
              '<div class="form-error">Sorry, there was an error sending your message. Please try again or contact us directly at support@wittleguys.net</div>';
          })
          .finally(() => {
            // Reset button state
            submitBtn.disabled = false;
            btnText.style.display = 'inline';
            btnLoading.style.display = 'none';
          });
        });

        console.log('Contact form with working reCAPTCHA loaded successfully');
        </script>
    </div>
</div>
{{ end }}
